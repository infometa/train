# ===========================================
# 轻量化激进高频版配置 (Lightweight Extreme HF)
# 基于 lightweight.yaml 的最新基础配置，强化高频与对抗
# ===========================================

data:
  # 路径配置（与基础版一致）
  vctk_path: "/data/audio/vctk/wav48_silence_trimmed"
  aishell3_path: "/data/audio/Aishell3/train/wav"
  ir_path: "/data/audio/impulse_responses/SLR26/simulated_rirs_48k"
  noise_path: "/data/audio/freesound/datasets_fullband/noise_fullband"
  
  # 使用过滤后数据集
  output_dir: "/data/train_data_snr"

  sample_rate: 48000
  segment_length: 24000
  save_segment_length: 48000
  segment_hop: 24000
  
  # 更激进的高质量策略
  snr_range: [18, 30]    # 提高下限，过滤低 SNR
  noise_prob: 0.7        # 增加纯净样本比例，保障低频能量
  ir_prob: 0.35          # 减少混响扰动，避免掩盖高频

  dataset_ratio:
    vctk: 0.3
    aishell3: 0.7

  val_ratio: 0.05
  
  align_df_delay: false
  align_max_shift: 4000
  align_sample_count: 32
  
  num_workers: 8

model:
  name: "CausalUNetGAN_Balanced"
  
  generator:
    in_channels: 1
    out_channels: 1
    channels: [48, 96, 192, 384]
    kernel_size: 7
    bottleneck_type: "gru"
    bottleneck_layers: 2
    use_weight_norm: true
    
  discriminator:
    scales: 2
    periods: [2, 3, 5, 7, 11]
    channels: [48, 96, 192, 384, 768]
    kernel_size: 5
    use_spectral_norm: true

training:
  batch_size: 24
  epochs: 80
  
  optimizer:
    type: "AdamW"
    lr_g: 5.0e-5
    lr_d: 5.0e-5
    betas: [0.8, 0.99]
    weight_decay: 0.01
  
  scheduler:
    type: "CosineAnnealingLR"
    T_max: 80
    eta_min: 1.0e-6
    warmup_epochs: 10
  
  loss_weights:
    l1: 1.0           # 适度提高，保留能量/相位
    multi_stft: 5.5   # 频域更强
    adversarial: 2.0  # 中高对抗力度
    feature_matching: 2.5
  
  stft_config:
    fft_sizes: [512, 1024, 2048]
    hop_sizes: [128, 256, 512]
    win_lengths: [512, 1024, 2048]
    sample_rate: 48000
    hf_weight: 5.0     # 强但相对稳健
    hf_cutoff: 3000
  
  gan_start_epoch: 10
  grad_clip: 0.1
  
  save_every: 5
  log_every: 400

inference:
  onnx_opset: 17
  simplify: true
  frame_size: 480
  lookahead: 0

distributed:
  enabled: true
  backend: "nccl"

logging:
  tensorboard: true
  wandb: false
  project_name: "timbre_restore_extreme_hf"
